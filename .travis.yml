language: go
sudo: false

matrix:
  include:
    - name: "Go 1.8"
      go: "1.8.x"
      env: GOLANGCILINT=none
    - name: "Go 1.9"
      go: "1.9.x"
      env: GOLANGCILINT=v1.10.2
    - name: "Go 1.10"
      go: "1.10.x"
      env: GOLANGCILINT=v1.15.0
    - name: "Go 1.11"
      go: "1.11.x"
      env: GOLANGCILINT=v1.17.1
    - name: "Go 1.12"
      go: "1.12.x"
      env: GOLANGCILINT=v1.19.1
    - name: "Go 1.13"
      go: "1.13.x"
      env: GOLANGCILINT=v1.19.1
    - name: "Go tip"
      go: "tip"
      env: GOLANGCILINT=v1.19.1
  allow_failures:
    - go: tip

os:
  - linux
  - osx

install:
  - go mod download || go get -u

before_script:
  - make lint-prepare

script:
  - if [[ "$(TRAVIS_GO_VERSION)" =~ "1.8" ]]; then echo 'Skipping golangci-lint'; else make lint; fi
  - make test
